---
title: "New Rules" 
subtitle: "Quantum Circuits, Cellular Automata, Complexity and Chaos"
author: "Austen Lamacraft (Cambridge)"
data: 
format:
  revealjs:
    theme: [default, reveal_custom.scss]
    slide-number: true
    hash: true
    center: true
    auto-stretch: false
    html-math-method: katex
    preview-links: true
    katex: {
      macros: {
        "\\abs" : "\\left|#1\\right|",
        "\\tr" : "\\operatorname{tr}",
        "\\sgn" : "\\operatorname{sgn}",
      },
      throwOnError: false,
    }
---


```{ojs}
P5 = require("p5")
```

Add cover image

```{ojs}
// Modified from https://observablehq.com/@tmcw/p5
// See also https://blog.djnavarro.net/posts/2023-01-14_p5js/
// This helper creates a div and attaches the sketch to it
function* createSketch(sketch, slideId) {
  
  const element = DOM.element('div');
  // element.setAttribute('id', divId);
  
  // p5.js really likes its target element to already be in the DOM, not just
  // floating around detached. So, before we call P5, we yield it, which puts
  // in the DOM.
  yield element;
  
  // This is ‘instance mode’ in p5 jargon: instead of relying on lots of
  // globals, we create a sketch that has its own copy of everything under p5.
  const instance = new P5(sketch, element, true);

  // This detects whether we are on the relevant slide (by slideId) and stops the loop if not
  Reveal.on('slidechanged', event => {
    if (!!event.currentSlide.querySelector("#" + slideId)) {
      instance.loop()
    }
    else {
      instance.noLoop()
    }
  } );
  
  // I think this next part is only if you use observable to update a sketch...

  // This is the tricky part: when you run P5(sketch, element), it starts a
  // loop that updates the drawing a bunch of times a second. If we were just
  // to call P5 repeatedly with different arguments, the loops would all keep
  // running, one on top of the other. So what we do is we use this cell
  // as a generator, and then when that generator is interrupted, like
  // when you update the code in the sketch() method, then we call instance.remove()
  // to clean it up.
  try {
    while (true) {
      yield element;
    }
  } finally {
    instance.remove();
  }

}
```

## Abstract

Many of you will have played with cellular automata such as Conway's Game of Life. These are model systems in which complex and chaotic behaviors emerge from simple dynamical rules.

Motivated by quantum computation, physicists have in recent years begun to study *quantum circuits*, which are in some way quantum analogues of cellular automata. In this talk I'll discuss some of the similarities and differences between these two classes of systems, and what they can teach us about classical and quantum dynamics more generally.

---

## Game of life

```{ojs}
import { life } from "./js/life.js";
createSketch(life, 'life');
```

---

## Game of life in space-time

<blockquote class="twitter-tweet" data-media-max-width="560">

<p lang="en" dir="ltr">

as a longtime fan of Conway's "Game of Life" algorithm i never once considered visualizing the time axis physically -- this is breathtaking and elegant to me<br><br>credit:<a href="https://t.co/qdPZiEAEPq">https://t.co/qdPZiEAEPq</a> <a href="https://t.co/yKDanPKvos">pic.twitter.com/yKDanPKvos</a>

</p>

— chris_cubosh (@cubosh) <a href="https://twitter.com/cubosh/status/1771013098079465833?ref_src=twsrc%5Etfw">March 22, 2024</a>

</blockquote>

```{=html}
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
```

---



### Rules of Life

- Each site either dead (0) or alive (1)

- Fate of cell determined by eight neighbors

  1. Any live cell with two or three live neighbours survives
  2. Any dead cell with three live neighbours becomes a live cell
  3. All other live cells die in the next generation

- Complex behavior!

---

### Cellular Automata

- Dynamical systems with discrete *space*, *time*, and *degrees of freedom* 

- Interesting for statistical physics:
  - What kinds of dynamics may occur?
  - How does dynamics determine thermodynamic behavior?

---

### Quantum Circuits

- A quantum analog of CAs

- Basis of "quantum supremacy" work by Google and others

<figure align="center">
<img src="images/google-sycamore-schematic.png" width="400"/>
<figcaption> A schematic view of the Google Sycamore processor.</figcaption>
</figure>

---

### This talk

- What are the similarities and differences?
 
- When is quantum dynamics harder?
 
 <p align="center" class="fragment">
<strong>Little quantum computation <i>per se</i>, though it saturates the field</strong>
</p>

---



Outline comments on cellular automata, Wolfram, Cambridge train station etc.

---

Appearance of casuality

---

# Outline

-   Isometries and maximal entanglement

The following result may be useful: if the state of two systems is described by a wavefunction $\Psi_{AB}$ such as the associated map is an isometry, the two systems are maximally entangled.

This is useful for seeing maximal entanglement due to dual unitarity, as we just have to be able to argue that the wedge is a unitary

## Tools

Intro to Penrose diagram notation

---

## What is a quantum circuit?

- A way to describe operations on quantum state, usually consisting of several __qubits__ (spin 1/2 subsystems with Hilbert space $\mathbb{C}^2$)

- Two quantum states $\ket{0}$ and $\ket{1}$  define the **computational basis**.

<p align="center">
<img src="images/Reversible_circuit_composition.svg.png" width="15%">
</p>

- $f$ acts on top five qubits, then $g$ acts on lower seven

---

## [Possible operations](https://en.wikipedia.org/wiki/Quantum_logic_gate)

<figure align="center">
<img src="images/Quantum_teleportation_circuit.svg.png" width="80%">
<figcaption>Source: <a href="https://en.wikipedia.org/wiki/Quantum_circuit">Wikipedia</a> </figcaption>
</figure>

1. $H$ (a [Hadamard gate](https://en.wikipedia.org/wiki/Quantum_logic_gate#Hadamard_gate)) is a __single qubit unitary__ 

2. Also __two qubit unitary gates__ (CNOT here)

3. Measurements

---

## Why consider circuits?

- __For this program:__ example of discrete time, many body dynamics

- Model of universal quantum computation 
  - How to generate an arbitrary quantum state
  - One of several options e.g. measurement-based

- _They exist!_ Companies (Google, IBM, etc.) have built platforms for gate-based QC

--- 

## Unitary circuits

- (Mostly) concerned with __unitary circuits__ made from __unitary gates__

- Gate is $n$-qubit unitary $U_{s_1\ldots s_n,s'_1,\ldots, s'_n}$

$$
\sum_{s_1'\ldots s_N'}U_{s_1\ldots s_n,s'_1,\ldots, s'_n} U^\dagger_{s'_1\ldots s'_n,s''_1,\ldots, s''_n}=\delta_{s_1,s_1''}\ldots \delta_{s_N,s_N''}
$$


---

## Everything is a tensor

- State of $N$ qubits expressed in product basis
  
$$
\ket{\Psi} = \sum_{s_{1:N}\in \{0,1\}^N} \Psi_{s_1\ldots s_N}\ket{s_1}_1\ket{s_2}_2\cdots \ket{s_N}_N
$$

- Write $\ket{s_1}_1\ket{s_2}_2\cdots \ket{s_N}_N =\ket{s_1\cdots s_N}=\ket{s_{1:N}}$ for brevity 

- Operator on $N$ qubits has matrix elements

$$
\mathcal{O}_{s_{1:N},s'_{1:N}} = \bra{s_{1:N}}\mathcal{O}\ket{s'_{1:N}}
$$

---


## Graphical notation

- A tensor is denoted by a blob with one leg for each index

- Connecting legs denotes contraction: summing over a shared index

<figure align="center">
<img src="images/contractions.png" width="100%">
<figcaption>See <a href="https://www.tensors.net/tutorial-1">Glen Evenbly's tensor contraction tutorial</a> </figcaption>
</figure>

---

## Unitary gates: one qubit

- Multiplication by a Pauli matrix: $X$, $Y$, or $Z$.

- General case $U = a_0\mathbb{1} + \mathbf{a}\cdot(X,Y,Z)$ with $|a_0|^2+|\mathbf{a}|^2=1$

- Other special cases used in quantum information e.g. [Hadamard gate](https://en.wikipedia.org/wiki/Quantum_logic_gate#Hadamard_gate)

$$
H = \frac{1}{\sqrt{2}}\begin{pmatrix}
1 & 1 \\\\
1 & -1
\end{pmatrix}
$$

---

## Two qubits

- Work in  basis $\ket{00}$, $\ket{01}$, $\ket{10}$, $\ket{11}$

- Simplest example is [SWAP gate](https://en.wikipedia.org/wiki/Quantum_logic_gate#Swap_gate)

$$
\operatorname{SWAP}=\begin{pmatrix}
1 & 0 & 0 & 0 \\\
0 & 0 & 1 & 0 \\\
0 & 1 & 0 & 0 \\\
0 & 0 & 0 & 1
\end{pmatrix}
$$.

$$
\operatorname{SWAP}\ket{10} = \ket{01}
$$

- SWAP takes product states to product states

---

- Slightly more complicated: square root of SWAP

$$
\sqrt{\operatorname{SWAP}}=\begin{pmatrix}
1 & 0 & 0 & 0 \\\
0 & \frac{1}{2}(1+i) & \frac{1}{2}(1-i) & 0 \\\
0 & \frac{1}{2}(1-i) & \frac{1}{2}(1+i) & 0 \\\
0 & 0 & 0 & 1
\end{pmatrix}
$$

- This generates _entanglement_: takes product state to non-product state

$$
\sqrt{\operatorname{SWAP}}\ket{10} = \frac{1}{2}\left[(1+i)\ket{10}+(1-i)\ket{01}\right]
$$

- $\sqrt{\operatorname{SWAP}}$ conserves number of 1s and 0s

- $\sqrt{\operatorname{SWAP}}$ together with arbitrary single qubit unitary operators form __universal gate set__ that allows for universal quantum computation

---

## General two qubit unitary

- Any two-qubit unitary $U\in \mathcal{U(4)}$ can be written

$$
U = e^{i \phi} (u_+ \otimes u_-) V[J_x, J_y, J_z] (v_- \otimes v_+)
$$

- $u_{\pm}, v_{\pm} \in SU(2)$

$$
\begin{align*}
 V[J_x, J_y, J_z] &= \exp \left[-i\left(J_x \sigma^x \otimes \sigma^x + J_y \sigma^y \otimes \sigma^y+ J_z \sigma^z \otimes \sigma^z\right)\right]\\\\
 &= \begin{bmatrix}
e^{-i J_z} \cos(J_-) & 0 & 0 & -i e^{-i J_z \sin(J_-)} \\\\
0 & e^{iJ_z} \cos(J_+) & -ie^{i J_z} \sin(J_+) & 0 \\\\
0 & -ie^{i J_z} \sin(J_+) & e^{iJ_z} \cos(J_+) & 0 \\\\
-i e^{-i J_z \sin(J_-)} & 0 & 0 & e^{-i J_z} \cos(J_-) \\\\
\end{bmatrix}
\end{align*}
$$

- 16 parameters!

---

## Time evolution

#### Single qubit gates

- Time evolution operator $U=\exp(-iHt)$

- If $H=\sum_j h_j$ a sum of single qubit terms

$$
\mathcal{U} = \exp(-iHt) = \prod_j \exp(-ih_j) = \prod_j U_j
$$
$$
U_j=\mathbb{1}\otimes \ldots \otimes\mathbb{1} \otimes \overbrace{u_j}^{j\text{th factor}} \ldots \otimes\mathbb{1}
$$

---

#### Two qubit gates

- Simplest example of two qubit interaction is __exchange Hamiltonian__

$$
\begin{align*}
h_{12} &= J\left[X\otimes X+Y\otimes Y+Z\otimes Z\right] =J\left[X_1X_2+Y_1Y_2 + Z_1Z_2\right]\\\
&=2\operatorname{SWAP} - 1
\end{align*}
$$
$$
U(J) = \exp(-ih_{12}) = e^{iJ}\left[\cos (2J) \mathbb{1} - i\sin (2J) \operatorname{SWAP}\right]
$$

- Special cases 

$$
U(\pi/4)=\operatorname{SWAP}
$$
$$
U(\pi/8)=\sqrt{\operatorname{SWAP}}
$$

- Fully rotationally invariant

---

- $H=\sum_{i,j} h_{i,j}$ a sum of two qubit terms with $[h_{i,j},h_{j,k}]\neq 0$

<figure align="center">
<img src="images/evenbly-hamiltonian.png" width="80%">
<figcaption>Source: <a href="https://www.tensors.net/exact-diagonalization">Glen Evenbly</a> </figcaption>
</figure>

- $\mathcal{U}\neq \prod_{i,j} \exp(-ih_{i,j})$. More complicated!

- __Suzuki–Trotter__ expansion: decompose $H=H_A + H_B$

$$
\mathcal{U} = \exp(-iH) = \left[\exp\left(-\frac{iH}{n}\right)\right]^n \sim \left[e^{-iH_A/n} e^{-iH_B/n}\right]^n 
$$

---

$$
H = \sum_j h_{j,j+1}
$$
$$
H_A = \sum_j h_{2j, 2j+1}\qquad H_B = \sum_j h_{2j-1, 2j}
$$
$$
e^{-iH_A/n}=\prod_j U_{2j,2j+1}\qquad e^{-iH_B/n} = \prod_j U_{2j-1,2j}
$$

---

Introduce notion of brickwall circuit

<p align="center">
<img src="images/brickwall.png" width="450"/>
</p>



---

## Floquet theory: kicked Ising model

- Time dependent Hamiltonian with kicks at $t=0,1,2,\ldots$.

$$
\begin{align*}
H_{\text{KIM}}(t) = H_\text{I}[\mathbf{h}] + \sum_{n}\delta(t-n)H_\text{K}\\\
H_\text{I}[\mathbf{h}]=\sum_{j=1}^L\left[J Z_j Z_{j+1} + h_j Z_j\right],\qquad H_\text{K} &= b\sum_{j=1}^L X_j,
\end{align*}
$$

- "Stroboscopic" form of $\mathcal{U}(t)=\mathcal{T}\exp\left[-i\int^t H_{\text{KIM}}(t') dt'\right]$

$$
\begin{aligned}
  \mathcal{U}(n_+) &= \left[\mathcal{U}(1_+)\right]^n,\qquad U(1_-) = K I_\mathbf{h}\\\
  I_\mathbf{h} &= e^{-iH_\text{I}[\mathbf{h}]}, \qquad K = e^{-iH_\text{K}}
\end{aligned}
$$

---

## KIM as a circuit

<p align="center">
<img src="images/kim-circuit.png" width="200"/>
</p>

$$
\begin{aligned}
  \mathcal{K} &= \exp\left[-i b X\right]\\\
  \mathcal{I} &= \exp\left[-iJ Z_1 Z_2 -i \left(h_1 Z_1 + h_2 Z_2\right)/2\right]
\end{aligned}
$$

---

## Locality 

- Locality a feature of real quantum computing architectures

<figure align="center">
<img src="images/google-sycamore-schematic.png" width="400"/>
<img src="images/google-sycamore-photo.png" width="400"/>
<figcaption> (top) a schematic view of the Google Sycamore processor and (bottom) the real thing</figcaption>
</figure>

---

## Computational complexity

- State is vector in $2^N$ dimensional space

- Updating involves acting with a unitary matrix

- Naive matrix-vector multiplication $O(\operatorname{dim}^2)=2^{2N}$

- Since gates gives *sparse* matrices update is $O(\operatorname{dim})=2^{N}$

-  Still _exponentially hard in the number of qubits_

---

## Quantum supremacy

- Difficulty on classical computer basis of ["quantum supremacy"](https://en.wikipedia.org/wiki/Quantum_supremacy) based on circuit sampling

- Measure empirical distribution of bit strings with fixed initial state

- Total number of (time) steps $T$ taken is  *depth* of the circuit. For low depth $T<N$ it pays to move  _horizontally_ instead

- Problem of finding optimal contraction strategy in general is NP-hard

- [Google's initial claim](https://www.nature.com/articles/s41586-019-1666-5) of supremacy disputed by supercomputer optimizations, followed by improved tensor network methods: [Huang _et al._ (2020)](https://arxiv.org/abs/2005.06787), [Gray and Kourtis (2021)](https://quantum-journal.org/papers/q-2021-03-15-410/), [Pan and Zhang (2021)](https://arxiv.org/abs/2103.03074), [Napp _et al._ (2022)](https://journals.aps.org/prx/abstract/10.1103/PhysRevX.12.021021)

---

## What are the quantities of interest?

---

## Causality

- Brickwork circuit has _natural lightcone_! ($c=1$)

<figure align="center">
<img src="images/causal.svg" width="70%">
</figure>

---

## Operator pushing

$$
\mathcal{O}'=\mathcal{U}^\dagger\mathcal{O}\mathcal{U}
$$

$$
\mathcal{U}\mathcal{O}'=\mathcal{O}\mathcal{U}
$$

<figure align="center">
<img src="images/operator_pushing.svg" width="50%">
</figure>

- Evidently $\mathcal{O}=\mathbb{1} \longleftrightarrow \mathcal{O}'=\mathbb{1}$


---

- Single qubit operator pushes to two qubit opertor

<figure align="center">
<img src="images/operator_pushing_two_qubit.svg" width="50%">
</figure>

---

- Apply repeatedly

<figure align="center">
<img src="images/causal_push.svg" width="100%">
</figure>

---

## No correlations outside light cone

$$
C(\mathcal{O}_1(t),\mathcal{O}_2(0)) \equiv \operatorname{tr}\left[\mathcal{U}_t^\dagger\mathcal{O}_1\mathcal{U}_t\mathcal{O}_2\right] = \operatorname{tr}\left[\mathcal{O}'_1\mathcal{O}_2\right] = \operatorname{tr}\left[\mathcal{O}'_1\right]\operatorname{tr}\left[\mathcal{O}_2\right]
$$

<figure align="center">
<img src="images/outside_lightcone.svg" width="100%">
</figure>

---

## Operator spreading

- Observable $Z_n(t)$ expanded in local products of Paulis

$$
Z_n,\qquad X_n Y_{n+1},\qquad Z_{n-1}Y_n X_{n+1},\cdots
$$




---

$$
Z_n(t)= \sum_{\mu_{1:N}=\{1,x,y,z\}^N} \mathcal{C}_{\mu_{1:N}}(t) \sigma_1^{\mu_1}\otimes\cdots \sigma_N^{\mu_N}
$$
$$
\mathcal{C}_{\mu_{1:N}}(0)=\begin{cases}
1 & \mu_j=z, \mu_k=1,\forall k\neq j \\\\
0 & \text{otherwise}
\end{cases}
$$

---

$$
Z_n(t)= \sum_{\mu_{1:N}\in\{1,x,y,z\}^N} \mathcal{C}_{\mu_{1:N}}(t) \sigma_1^{\mu_1}\otimes\cdots \sigma_N^{\mu_N}
$$

- Since $\operatorname{tr}\left[\sigma_\alpha\sigma_\beta\right]=2\delta_{\alpha\beta}$, can extract spin correlations from $\langle Z_j(t)Z_k(0)\rangle=C_{jk}(t) \equiv \mathcal{C}_{1\cdots \mu_k=z \cdots 1}(t)$

<figure align="center">
<img src="images/initial-terminal.png" width="400">
</figure>

- Represents only one component of operator expansion

---


## KIM at $J=b=h=\pi/4$

- In this case only _one term_ in operator expansion

<figure align="center">
<img src="images/z2-clifford-z.png" width="50%">
</figure>

- Fractal pattern of $Z$ operators

---

$$
\mathcal{O}_{AB}\equiv\prod_{x=1}^N Z_x^{a_{x}}X_x^{b_{x}}\qquad a_{x}, b_{x}\in \{0,1\}
$$

$$
\mathcal{U}^\dagger_t \mathcal{O}_{A_0B_0}\mathcal{U}_t \equiv \mathcal{O}_{A_t B_t}
$$

- Gives $A_t=(a_{0,t}, \ldots, a_{N,t})$ and $B_t=(b_{0,t}, \ldots, b_{N,t})$

- This is a _Clifford circuit_

---

$$
\mathcal{O}_{AB}\equiv\prod_{x=1}^N Z_x^{a_{x}}X_x^{b_{x}}\qquad a_{x}, b_{x}\in \{0,1\}
$$

$$
\begin{aligned}
a_{x,t+1} &= \alpha(a_{x,t}-b_{x-1,t}-b_{x+1,t}) + (\alpha\delta -1)b_{x,t}\\
b_{x,t+1} &= a_{x,t} - b_{x-1,t} - b_{x+1,t}+\delta b_{x,t}
\end{aligned}\mod 2
$$

$$
\begin{aligned}
\left[\Delta b\right]_{x,t} &= (\alpha + \delta - 4)b_{x,t}\\
\left[\Delta b\right]_{x,t} &\equiv  b_{x,t+1} + b_{x+1,t-1} + b_{x+1,t} + b_{x-1,t} - 4b_{x,t}
\end{aligned}\mod 2
$$


---

Do also the chaotic one from Sommers...

Notion of scrambling... big spread of operator

How to quantify???


---

## Out of time order correlator

$$
\operatorname{OTOC}_{jk}(t) \equiv \langle Z_j(t)Z_k(0)Z_j(t)Z_k(0)\rangle
$$

- OTOC sometimes written as squared commutator

$$
\langle \left[Z_k(0),Z_j(t)\right]^2 \rangle
$$

- Relation between two expressions is (using $Z^2=1$)

$$
\operatorname{OTOC}_{jk}(t) = \frac{1}{2}\langle \left[Z_k(0),Z_j(t)\right]^2 \rangle + 1
$$


---

$$
\operatorname{OTOC}_{jk}(t) = \frac{1}{2}\langle \left[Z_k(0),Z_j(t)\right]^2 \rangle + 1
$$

 - At short times commutator vanishes so $\operatorname{OTOC}_{jk}(t\to 0)=1$
 
$$
\operatorname{OTOC}\_{jk}(t)= 2^{N-1} \sum_{\mu_{1:N}}\mathcal{C}\_{\mu_{1:N}}^2(t)\left[\delta_{\mu_k,0}+\delta_{\mu_k,3}-\delta_{\mu_k,1}-\delta_{\mu_k,2}\right]
$$

- $\operatorname{OTOC}\_{jk}(t)\neq 1$ after operator $Z_j(t)$ spreads from site $j$ to site $k$ 

- Characteristic speed of propagation of OTOC is "butterfly velocity" $v_\text{B}$


- Since OTOC depends on *square* of the coefficients, a nonzero value survives after averaging over random circuits

---

## Google's OTOC experiment

- OTOC measured in 2021 by [Google](https://www.science.org/doi/full/10.1126/science.abg5029?casa_token=TkmMj95XIYoAAAAA:NP67A_aYhL8lSDWtuG99i8oFfx1c79-Lz-UGKYsW1-bee3hQ7weJSxLLQwpPzfSEPvEqt6SPbB4UYA) 

<figure align="center">
<img src="images/google-otoc.png" width="1000">
<figcaption> The measured OTOC for $i\operatorname{\operatorname{\mathsf{SWAP}}}$ gates (top) and $\sqrt{i\operatorname{\mathsf{SWAP}}}$ (bottom) after averaging over single qubit gates.</figcaption>
</figure>


---

The term scrambling... what does it mean

Chaos....

---


After describing Clifford dynamics and doing entanglement for SWAP, go on to dual unitaries in general 

Picture where entanglement follows from isometry

More generally.... any time MPS gives isometry along bottom

Isometry property shows how correlations are restricted....


Triunitarity... just follows from decomposition of CNOT

Then chaos...

Operator entanglement .... magic... non cliffordness


Page curve between recurrences??? Goes back down

---


## Quantifying entanglement

- RDM quantifies entanglement present in a quantum state describing a system composed of two subsystems A and B

- General state is vector $\in\mathcal{H}=\mathcal{H}_A\otimes\mathcal{H}_B$  

- Write in terms of basis vectors $\ket{a}_A$ and $\ket{b}_B$ for A and B subsystems
$$
\ket{\Psi}_{AB} = \sum_{a=1}^{n_A}\sum_{b=1}^{n_B} \Psi_{ab}\ket{a}_A\ket{b}_B 
$$
$n_{A/B}=\operatorname{dim} \mathcal{H}_{A/B}$

- Now regard $\psi_{ab}$ as matrix and perform a singular value decomposition

---

- In new bases our state is

$$
\ket{\Psi}_{AB} = \sum_{n=1}^{\min(n_A, n_B)} \sigma_n \ket{u_n}_A\otimes\ket{v_n}_B
$$

- Note _single sum_, c.f. double sum earlier. This is [Schmidt decomposition](https://en.wikipedia.org/wiki/Schmidt_decomposition) 

- $\sigma_n$ are Schmidt coefficients (singular values of SVD)

- If only one nonzero singular value state we have _product state_,  indicating no correlations between subsystems

---

- Simplest example displaying nontrivial entanglement is [Bell state](https://en.wikipedia.org/wiki/Bell_state) 

$$
\left|\Psi^{+}\right\rangle=\frac{1}{\sqrt{2}}\left(|0\rangle_A \otimes|1\rangle_B+|1\rangle_A \otimes|0\rangle_B\right)
$$

- Schmidt coefficients both $\frac{1}{\sqrt{2}}$, indicating maximal entanglement

- Schmidt decomposition closely related to _reduced density matrix_
$$
\rho_A = \operatorname{tr}_B\left[\ket{\Psi}\bra{\Psi}\right] 
= \sum_n \sigma_n^2 \ket{u_n}\bra{u_n}
$$

- Eigenvalues of RDM are $p_n=\sigma_n^2$


---

## Two important facts

1.  $\rho_A = \operatorname{tr}_B\left[\ket{\Psi}\bra{\Psi}\right]$ unchanged by _unitary transformation on B_

2. $\operatorname{spec}(\rho_A)$ unchanged by _unitary transformation on A_

---

- One measure of entanglement is von Neumann entropy of $\rho_A$ (aka **entanglement entropy**)

$$
S^{(\text{vN})}_A \equiv -\operatorname{tr}\left[\rho_A\log \rho_A\right] = \sum_n -p_n \log p_n
$$

- $S_A$ vanishes for product state, and is otherwise positive

---

- [Rényi entropies](https://en.wikipedia.org/wiki/R%C3%A9nyi_entropy) provide more complete information
$$
  S^{(\alpha)}_A = \frac{1}{1-\alpha}\log \text{tr}\left[\rho^n\right]=\frac{1}{1-\alpha}\sum_n p_n^\alpha
$$
$S^{(\text{vN})}_A=\lim_{\alpha\to 1} S^{(\alpha)}_A$. $S^{(0)}_A$ is number of nonzero Schmidt coefficients (aka [Schmidt rank](https://en.wikipedia.org/wiki/Schmidt_decomposition#Schmidt_rank_and_entanglement))
$$
S^{(2)}_A = -\log \sum_n p_n^2 = -\log \gamma\operatorname{tr}
$$
where $\gamma\equiv \operatorname{tr}\rho_A^2$ is [purity](https://en.wikipedia.org/wiki/Purity_(quantum_mechanics))

- Do we need this slide??

---

## Toy model

- Circuit of SWAP gates
<figure align="center">
<img src="images/bell-swap.png" width="80%"/>
</figure>

- Initial state is product of Bell states
$$
\ket{\Phi^+}_{2n, 2n+1} = \frac{1}{\sqrt{2}}\left[\ket{0}_{2n}\ket{0}_{2n+1}+ \ket{1}_{2n}\ket{1}_{2n+1}\right]
$$
$$
\operatorname{tr}_{2}\left[\ket{\Phi^+}_{12}\bra{\Phi^+}_{12}\right] = \frac{1}{2}\mathbb{1}_1
$$
with entanglement entropy of one bit

---

<figure align="center">
<img src="images/bell-swap.png" width="80%"/>
</figure>

- $\rho_A$ therefore has factor $\mathbb{1}_n$ for each site $n\in A$ with "partner" in $B$

- If _both_ qubits of a Bell pair are at sites  $n,m\in A$ they give a factor $\ket{\Phi^+}_{nm}\bra{\Phi^+}_{nm}$: a pure state

- Entanglement entropy has contributions from first case only

$$
 S_A = \min(4\lfloor t/2\rfloor, |A|) \text{ bits}
$$

---

$$
 S_A = \min(4\lfloor t/2\rfloor, |A|) \text{ bits}
$$

- After time $\sim |A|/2$ subsystem has thermalized. 

<figure align="center">
<img src="images/bertini.png" width="400">
<figcaption> 
Source:  <a href="https://journals.aps.org/prx/abstract/10.1103/PhysRevX.9.021033">Bertini et al. (2019)</a>
</figcaption>
</figure>


--- 

- Ramp behaviour in many systems

- In noninteracting systems or integrable systems, often explained in terms of the causal propagation of (quasi-)particles:

<figure align="center">
<img src="images/qp.png" width="300">
<figcaption> 
Source:  <a href="https://iopscience.iop.org/article/10.1088/1742-5468/2005/04/P04010/meta">Calabrese and Cardy (2005)</a>
</figcaption>
</figure>

---

- Toy model with SWAP gates is rather similar, with qubits playing the role of "noninteracting particles"

- This picture remains true in circuits where there is no quasiparticle interpretation

---

## Dual unitary circuits

---

## Recall: kicked Ising model

- Time dependent Hamiltonian with kicks at $t=0,1,2,\ldots$.

$$
\begin{align*}
H_{\text{KIM}}(t) = H_\text{I}[\mathbf{h}] + \sum_{n}\delta(t-n)H_\text{K}\\\
H_\text{I}[\mathbf{h}]=\sum_{j=1}^L\left[J Z_j Z_{j+1} + h_j Z_j\right],\qquad H_\text{K} &= b\sum_{j=1}^L X_j
\end{align*}
$$

---

## Entanglement Growth for KIM

- [Bertini, Kos, Prosen (2019)](https://journals.aps.org/prx/abstract/10.1103/PhysRevX.9.021033) found that when $|J|=|b|=\pi/4$

$$
\lim_{L\to\infty} S_A =\min(2t-2,N_A)\log 2,
$$

- __Any $h_j$__; initial $Z_j$ product state

<p align="center">
<img src="images/bertini.png" width="500"/>
</p>

---

## Entanglement Spectrum


- Rényi entropies depend on eigenvalues of reduced density matrix

$$
  S^{(\alpha)}_A = \frac{1}{1-\alpha}\log \text{tr}\left[\rho^\alpha\right]=\frac{1}{1-\alpha}\sum_n p_n^\alpha
$$

- For SDKIM have $2^{\min(2t-2,N_A)}$ non-zero eigenvalues all equal

$$
p_n = \left(\frac{1}{2}\right)^{\min(2t-2,N_A)}
$$

---

## Thermalization

- After $N_A/2 + 1$ steps, reduced density matrix is $\propto \mathbb{1}$

- All expectations (with $A$) take on infinite temperature value

---

## Dual unitarity

- Recall KIM has circuit representation

<p align="center">
<img src="images/kim-circuit.png" width="150"/>
</p>

$$
\begin{aligned}
  \mathcal{K} &= \exp\left[-i b X\right]\\
  \mathcal{I} &= \exp\left[-iJ Z_1 Z_2 -i \left(h_1 Z_1 + h_2 Z_2\right)/2\right]
\end{aligned}
$$

- At $|J|=|b|=\pi/4$ has additional property of __dual unitarity__

---

## Reminder from last lecture

<figure align="center">
<img src="images/matrix_elements.svg" width="90%">
</figure>


<figure align="center">
<img src="images/diag_unitarity.png" width="60%">
</figure>

---

## "Folded" representations

<p align="center">
<img src="images/diag_folded.png" width="60%">
</p>

- Unitarity:

<p align="center">
<img src="images/folded-unitarity.png" width="50%">
</p>

---

## Dual unitary gates

- Impose additional restriction

<figure align="center">
<img src="../new-rules-tum/assets/folded-dual-unitarity.png" width="60%">
</figure>

- [Gopalakrishnan and Lamacraft (2019)](https://journals.aps.org/prb/abstract/10.1103/PhysRevB.100.064309), [Bertini, Kos, and Prosen (2019)](https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.123.210601)

---


## Isometry

<figure align="center">
<img src="images/isometry.svg" width="100%">
</figure>


---

- Observation: if $\Psi_{AB}$ is a unitary matrix

$$
\ket{\Psi}_{AB} = \sum_{a=1}^{n_A}\sum_{b=1}^{n_B} \Psi_{ab}\ket{a}_A\ket{b}_B 
$$

- In new bases our state is

$$
\ket{\Psi}_{AB} = \sum_{n=1}^{\min(n_A, n_B)} \sigma_n \ket{u_n}_A\otimes\ket{v_n}_B
$$

---

More general initial states... MPS

---

Quote general result showing converse from Harrow


---

Temporal entanglement... Abanin... Fux

---

---

## $\rho_A$ via dual unitarity

- Initial state of NN Bell pairs

- 8 sites; 4 layers

<object data="../new-rules-tum/assets/A-entropy-quantum.svg" type="image/svg+xml"></object>

- $\rho_A$ is unitary transformation of
  
$$
  \mathbb{1}\otimes\mathbb{1}\otimes\mathbb{1}\otimes\mathbb{1}\otimes\mathbb{1}\otimes\mathbb{1}\otimes\mathbb{1}\otimes\mathbb{1}
$$

---

## Shallower...

<object data="../new-rules-tum/assets/A-entropy-quantum-shallower.svg" type="image/svg+xml"></object>

- $\rho_A$ is unitary transformation of 
  
$$
\mathbb{1}\otimes\mathbb{1}\ket{\Phi^+}\bra{\Phi^+}\otimes\ket{\Phi^+}\bra{\Phi^+}\otimes\mathbb{1}\otimes\mathbb{1}
$$

---

## General case

- RDM is unitary transformation of 

$$
\rho_0=\overbrace{\frac{\mathbb{1}}{2}\otimes \frac{\mathbb{1}}{2} \cdots }^{t-1} \otimes\overbrace{\ket{\Phi^+}\bra{\Phi^+} \cdots }^{N_A/2-t+1 } \otimes \overbrace{\frac{\mathbb{1}}{2}\otimes \frac{\mathbb{1}}{2} \cdots }^{t-1}
$$

- RDM has $2^{\min(2t-2,N_A)}$ non-zero eigenvalues all equal to $\left(\frac{1}{2}\right)^{\min(2t-2,N_A)}$


- Converse – maximal entanglement growth implies dual unitary gates – recently proved by [Zhou and Harrow (2022)](https://arxiv.org/abs/2204.10341)

---

## The dual unitary family

- $4\times 4$ unitaries are 16-dimensional

- Family of dual unitaries is 14-dimensional
 
- Includes *kicked Ising model* at particular values of couplings
  
- Dual unitaries not "integrable" but have enough structure to allow many calculations

---

## 'KIM' property

<p align="center">
<img src="../new-rules-tum/assets/fig_KIMidentity.png" width="400"/>
</p>

- ($q=2$ here) Not satisfied by e.g. $\operatorname{SWAP}$

- Maps product states to maximally entangled (Bell) states

- Product initial states also work for KIM!

- [Piroli _et al_ (2020)](https://journals.aps.org/prb/abstract/10.1103/PhysRevB.101.094304) studied more general initial states

- [Foligno and Bertini (2023)](https://journals.aps.org/prb/abstract/10.1103/PhysRevB.107.174311) study general initial conditions

---

## Correlation functions

- Infinite temperature correlator $\operatorname{tr}\left[\sigma^\alpha_x(x,t)\sigma^\beta(y,0)\right]$

<figure align="center">
<img src="assets/correlator.png" width="75%"/>
</figure>

- [Bertini, Kos, and Prosen (2019)](https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.123.210601): dual unitarity means correlations vanish _inside_ light cone!

---

## Quantinuum experiment

- Correlations measured in SDKIM [last year]((https://www.nature.com/articles/s41567-022-01689-7))

<figure align="center">
<img src="assets/quantinuum.png" width="800">
</figure>

---

## Other applications of dual unitarity


- [Claeys and Lamacraft (2020)](https://journals.aps.org/prresearch/abstract/10.1103/PhysRevResearch.2.033032). $v_\text{B}=1$. OTOC grows at maximum speed, c.f. Google experiment

- [Jonay, Kehmani, Ippoliti (2021)](https://journals.aps.org/prresearch/abstract/10.1103/PhysRevResearch.3.043046). Triunitary circuits (incl. 2+1 dimensions)

- [Stephen _et al_ (2022)](https://arxiv.org/abs/2209.06191). Measurement based quantum computation in 1D using dual unitaries 

- [Sommers, Huse, Gullans (2022)](https://arxiv.org/abs/2210.10808). Dual unitary Clifford automata with applications to codes

- [Suzuki, Mitarai, Fujii (2022)](https://quantum-journal.org/papers/q-2022-01-24-631/). Computational power of dual unitaries

- Many more!

- Dual unitary shadows




---

## Remark: operator entanglement

- OTOC provides one measure of operator spreading

- Another question: how many nonzero coefficients  $\mathcal{C}\_{\mu_{1:N}}$?

- Introduce Schmidt decomposition _for operators_ 
$$
\mathcal{O}_{AB} = \sum_{n=1}^{\min(n^2_A, n^2_B)} \Sigma_n A_n\otimes B_n
$$

- $\Sigma_n\geq 0$ are operator Schmidt coefficients

- $A_n$ and $B_n$ are orthonormal operators on $\mathcal{H}_A$ and $\mathcal{H}_B$ i.e. $\operatorname{tr}\left[A^\dagger_m A_n\right]=\operatorname{tr}\left[B^\dagger_m B_n\right]=\delta_{mn}$

---

- Same entanglement measures as before be applied to evaluate the operator entanglement

- Simplest example, analogous to Bell state, is SWAP operator

$$
\operatorname{\mathsf{SWAP}}=\frac{1}{2}\left[X\otimes X+Y\otimes Y+Z\otimes Z + \mathsf{1}\otimes\mathsf{1}\right]
$$

- All Schmidt coefficients are equal (maximum operator entanglement)


---

## Expectation values

- Evaluate $\bra{\Psi}\mathcal{O}\ket{\Psi}=\bra{\Psi_0}\mathcal{U}^\dagger\mathcal{O}\mathcal{U}\ket{\Psi_0}$ for local operator $\mathcal{O}$

  - Simplest example: $X$, $Y$, or $Z$ for one qubit


  - $\mathcal{U}$ is *overall* unitary operator describing whole circuit


---

## Unitarity in graphical notation

- Have to consider both unitaries and conjugates

- Introduce color-coded notation 

<figure align="center">
<img src="images/matrix_elements.svg" width="70%">
</figure>

---

- Condition of unitarity $U^\dagger U = U U^\dagger = \mathsf{1}$

$$
\sum\_{\alpha,\beta}U^{\vphantom{\dagger}}_{a,b,\alpha,\beta} U^\dagger\_{\alpha,\beta,c,d}=\delta\_{ac}\delta\_{bd}
$$

- Unitarity of two qubit gate expressed as

<figure align="center">
<img src="images/diag_unitarity.png" width="70%">
</figure>

- Much better!

---

## Using unitarity

- $\bra{\Psi}\mathcal{O}\ket{\Psi}=\bra{\Psi_0}\mathcal{U}^\dagger\mathcal{O}\mathcal{U}\ket{\Psi_0}$ has diagrammatic representation
<div align="center"> 
<object data="assets/expectation.svg" type="image/svg+xml" width='600'></object>
</div>

- (leave initial state $\ket{\Psi}$ unspecified for the moment)

---

## "Folded" representations

- Since every $U$ accompanied by $U^\dagger$, include both in single unit by "folding" one on top of the other

<p align="center">
<img src="images/diag_folded.png" width="60%">
</p>

- Lines correspond to two indices, and therefore $2^2=4$ dimensions

- Unitarity condition takes form:

<p align="center">
<img src="images/folded-unitarity.png" width="50%">
</p>

---

- In folded picture expectation value $\bra{\Psi}\mathcal{O}\ket{\Psi}$ looks like this

<figure align="center">
<object data="images/folded-expectation.svg" type="image/svg+xml"></object>
<figcaption>
Click to apply unitary condition!
</figcaption>
</figure>

- "Light cone" emerges, reflecting region of circuit that affects expectation value

---

## Reduced density matrix

- Expectation value of operator in region $A$ can be computed from *reduced density matrix* $\rho_A$ for region $A$
$$
\rho_A = \operatorname{tr}\_{B}\left[\ket{\Psi}\bra{\Psi}\right]=\operatorname{tr}_{B}\left[\mathcal{U}\ket{\Psi_0}\bra{\Psi_0}\mathcal{U}^\dagger\right]
$$
($B$ is complement of $A$)

---

<object data="assets/reduced-density-matrix.svg" type="image/svg+xml"></object>

- Initial RDM of bottom part of wedge is all that matters!


---

## Correlation functions

- Natural correlation function to consider is

$$
c_{\alpha \beta}(x,t) = \frac{1}{2^N}\tr\left[\sigma_{\alpha}(x,t) \sigma_{\beta}(0,0) \right],\qquad \sigma_\alpha(x,t)=\mathcal{U}^\dagger(t)\sigma_\alpha(x)\mathcal{U}(t)
$$

- Average overall all initial states uniformly

- This is "infinite temperature", although temperature is not defined

---

## Graphical representation

$$
c_{\alpha \beta}(x,t) = \frac{1}{2^N}\tr\left[\sigma_{\alpha}(x,t) \sigma_{\beta}(0,0) \right],\qquad \sigma_\alpha(x,t)=\mathcal{U}^\dagger(t)\sigma_\alpha(x)\mathcal{U}(t)
$$

<figure align="center">
<img src="assets/correlator.png" width="800">
</figure>

---

- When $|x|>t$ unitarity condition leads to removal of _all_ $U$s and $U^\dagger$s 
$$
c_{\alpha \beta}(x,t) = \frac{1}{4}\tr\left[\sigma_{\alpha}\right]\tr\left[\sigma_{\beta}\right]=0,
$$
and correlations vanish (if operators are traceless)

- Correlations only nonzero inside "light cone"

---

- When $|x|=t$ remaining tensor network is particularly simple:

<figure align="center">
<img src="assets/diag_corr_2.png" width="400">
</figure>

---

- Rewrite in several ways, including in folded representation:

<figure align="center">
<img src="assets/diag_corr_channel.png" width="400">
</figure>

- $q$ is local Hilbert space dimension ($q=2$ up to now)

- Normalization factor by comparing with $\sigma_\alpha=\sigma_\beta=\mathsf{1}$ (here $t=4$)

---

- Evaluate by iteratively applying operator map $\mathcal{M}\_+$ or $\mathcal{M}\_-$

<figure align="center">
<img src="assets/diag_M_plus.png" width="400">
<img src="assets/diag_M_min.png" width="400">
</figure>

$$
\begin{align*}
\langle \sigma\_{\alpha}(t,t) \sigma\_{\beta}(0,0) \rangle &= \tr \left[\sigma\_{\beta}\mathcal{M}\_{-}^t(\sigma\_{\alpha})\right] / q \\\
&=  \tr \left[ \sigma\_{\alpha}\mathcal{M}\_{+}^{t}(\sigma\_{\beta})\right] / q
\end{align*}
$$

- $\mathcal{M}\_\pm$ are examples of [quantum channels](https://en.wikipedia.org/wiki/Quantum_channel): completely positive trace preserving maps between spaces of operators

- $\mathcal{M}\_\pm$ have the additional property of being _unital_: $\mathcal{M}\_\pm(\mathsf{1})=\mathsf{1}$

---

## Typical behaviour of correlations

<figure align="center">
<img src="assets/corr.png" width="500">
<figcaption>
Source: <a href="https://journals.aps.org/prresearch/abstract/10.1103/PhysRevResearch.2.033032">Claeys and Lamacraft (2020)</a>
</figcaption>
</figure>

---

- Can evaluate correlation inside light cone

<figure align="center">
<img src="assets/correlator.png" width="600">
</figure>

- "One step inside" involves quantum channel acting on two-site operators: a space of dimension $q^4$. 

- Taking $s$ steps inside channel acting on $q^{2s}$-dimensional space

- General situation is really exponentially hard, as we'd expect

---

## Operator spreading

- How does a local operator "look" as it evolves in Heisenberg picture?

- $Z_n(t)=\mathcal{U}^\dagger(t)Z_n \mathcal{U}(t)$ appears in $\langle Z_n(t)Z_m(0) \rangle$, but this is only one "component" of $Z_n(t)$

- Any observable such as $Z_n(t)$ can be expressed as expansion
$$
Z_n(t)= \sum_{\mu_{1:N}=\\{1,x,y,z\\}^N} \mathcal{C}\_{\mu_{1:N}}(t) \sigma_1^{\mu_1}\otimes\cdots \sigma_N^{\mu_N}
$$
$$
\mathcal{C}\_{\mu_{1:N}}(0)=\begin{cases}
1 & \mu_j=z, \mu_k=1,\forall k\neq j \\\\
0 & \text{otherwise}
\end{cases}
$$

---

$$
Z_n(t)= \sum_{\mu_{1:N}=\\{1,x,y,z\\}^N} \mathcal{C}\_{\mu_{1:N}}(t) \sigma_1^{\mu_1}\otimes\cdots \sigma_N^{\mu_N}
$$

- Since $\operatorname{tr}\left[\sigma_\alpha\sigma_\beta\right]=2\delta_{\alpha\beta}$, can extract spin correlations from $\langle Z_j(t)Z_k(0)\rangle=C_{jk}(t) \equiv \mathcal{C}_{1\cdots \mu_k=z \cdots 1}(t)$

<figure align="center">
<img src="images/initial-terminal.png" width="400">
</figure>

- This represents only one component of operator expansion

---

- Operator norm $\operatorname{tr}\left[Z_n^2(t)\right]=2$ is conserved under time evolution

- This implies the normalization

$$
\sum_{\mu_{1:N}=\{1,x,y,z\}^N} \mathcal{C}^2_{\mu_{1:N}}(t) = \frac{1}{2^{N-1}}
$$

---

## Example: $SU(2)$ preserving gate

- Consider gate generated by exchange Hamiltonian:
$$
U\_{j,j+1} = \cos\theta \mathbb{1}\_{j,j+1} + i\sin\theta \operatorname{\mathsf{S}}\_{j.j+1}
$$
$\operatorname{\mathsf{S}}_{j,j+1}$ denotes $\operatorname{\mathsf{SWAP}}$ gate on sites $j$ and $j+1$

- Action of this gate on an operator is

$$
\mathcal{O} \longrightarrow U^\dagger\_{j,j+1}\mathcal{O}U\_{j,j+1} = \cos^2\theta \mathcal{O} + \sin^2\theta \operatorname{\mathsf{S}}\_{j.j+1}\mathcal{O} \operatorname{\mathsf{S}}\_{j.j+1} \\\
-i\sin\theta\cos\theta \left[\operatorname{\mathsf{S}}\_{j.j+1}, \mathcal{O}\right]
$$

---

---

## Physical quantites

-   Causality and light cones. How to show that unitarity is related to causality

-   Notions of operator spreading and operator entanglment

-   Operator pushing

- Include fact that for dual unitaries operator can't push to operator with component having identity on opposite side (why not? because identity pushes to identity)

-   OTOC and Google experiment

- Operator entanglement

-   Temporal entanglement and notion of bath (refer to Gerald stuff). Again follows from isometry property

-   Spectral statistics and quantum chaos

- Random circuits

-   Simple example of Heisenberg circuit maybe?

-   Superdiffusion

## Quantum models

-   Floquet time evolution
-   Trotterization
-   Quantum circuits
-   SDKI as a paradigmatic system

## Classical models

-   Spatiotemporal cat
-   Connection to SDKI
-   Clifford automata. Sometimes QM is _not_ harder than classical physics
-   Automata with gliders vs. fractal growth

## Graphical methods

-   ZX calculus
-   Triunitary condition
-   Liu Ho model and East

## Frontiers

-   Measurements

-   Pieter recent measurement work

- Hayden Preskill

-   Lorentz symmetry

-   Simple examples of rules for CAs

-   Connections to nontrivial geometries eg. HaPPY code

-   Recent Kos work on stabilizer entropy for kicked XY

-   Recent Luca work on emergent dual unitarity

Experiments -- Quantinuum and recent paper https://arxiv.org/abs/2405.07613. Also holographic paper